webpackJsonp([1],{"+VGo":function(t,e){},0:function(t,e,n){t.exports=n("NHnr")},AsWo:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("/5sW"),r=(n("A0n/"),n("fx22"),n("NM/j")),a=n.n(r),s=[-2,-1],o=[1,1],h=100,u={props:{width:{type:Number,default:640},height:{type:Number,default:500}},data:function(){return{renderTime:0,startPoint:null,r1:s,r2:o}},mounted:function(){this.renderMandelbrot(),document.addEventListener("keypress",this.onKeyPress)},beforeDestroy:function(){document.removeEventListener("keypress",this.onKeyPress)},methods:{getTarget:function(){return this.$refs.container},onMouseDown:function(t){this._dragRectContext=this.$refs.dragRect.getContext("2d"),this._rect=this.$refs.container.getBoundingClientRect();var e=t.clientX-this._rect.left,n=t.clientY-this._rect.top;this.startPoint=[e,n]},onMouseMove:function(t){if(this.startPoint){var e=this._rect,n=t.clientX-e.left,i=t.clientY-e.top;this.endPoint=[n,i],this.updateDragRect(this.startPoint,[n,i])}},onMouseUp:function(t){if(this.updateDragRect(),this.startPoint&&this.endPoint){var e=a()(this.startPoint,2),n=e[0],i=e[1],r=a()(this.endPoint,2),s=r[0],o=r[1],h=Math.min(n,s),u=Math.min(i,o),c=Math.max(n,s),f=Math.max(i,o),l=d(h,u,[this.width,this.height],this.r1,this.r2),v=d(c,f,[this.width,this.height],this.r1,this.r2);this.r1=l,this.r2=v,this.renderMandelbrot()}this.startPoint=null,this.endPoint=null,this._dragRectContext=null},onKeyPress:function(t){" "!=t.key||c(this.r1,this.r2)||(this.r1=s,this.r2=o,this.renderMandelbrot())},updateDragRect:function(t,e){var n=this._dragRectContext;if(n.clearRect(0,0,this.width,this.height),t&&e){var i=a()(t,2),r=i[0],s=i[1],o=a()(e,2),h=o[0],u=o[1];n.strokeStyle="#00ff00",n.strokeRect(Math.min(r,h),Math.min(s,u),Math.abs(r-h),Math.abs(s-u))}},renderMandelbrot:function(){for(var t=this.$refs.canvas.getContext("2d"),e=performance.now(),n=t.createImageData(this.width,this.height),i=n.data,r=0;r<this.width;r++)for(var a=0;a<this.height;a++){var s=4*r+4*a*this.width,o=d(r,a,[this.width,this.height],this.r1,this.r2),u=f(o,h);u=-1!=u?255-u:0,i[s]=u,i[s+1]=u,i[s+2]=u,i[s+3]=255}t.putImageData(n,0,0),this.renderTime=performance.now()-e}}};function c(t,e){return t&&e&&t[0]==e[0]&&t[1]==e[1]}function d(t,e,n,i,r){var a=r[0]-i[0],s=i[1]-r[1];return[i[0]+t*a/n[0],i[1]-e*s/n[1]]}function f(t,e){for(var n=0,i=0,r=0;r<e;r++){var a=n*n-i*i+t[0],s=2*n*i+t[1];if(n=a,i=s,n*n+i*i>4)return r}return-1}var l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"container",staticClass:"container",style:{width:t.width+"px",height:t.height+"px"},on:{mousedown:t.onMouseDown,mousemove:t.onMouseMove,mouseup:t.onMouseUp}},[0!=t.renderTime?n("h1",[t._v(t._s(t.renderTime.toFixed(3))+" ms")]):t._e(),n("canvas",{ref:"canvas",attrs:{width:t.width,height:t.height}}),n("canvas",{ref:"dragRect",attrs:{width:t.width,height:t.height}})])},v=[],g=n("XyMi");function m(t){n("AsWo")}var p=!1,w=m,M="data-v-39e03f1e",y=null,b=Object(g["a"])(u,l,v,p,w,M,y),_=b.exports,x={props:{width:{type:Number,default:640},height:{type:Number,default:500}},mounted:function(){Module.canvas=this.$refs.canvas,Module.calledRun?Module.startApp():Module.addOnPostRun(function(){Module.startApp()})},methods:{getTarget:function(){return this.$refs.canvas}}},P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container",style:{width:t.width+"px",height:t.height+"px"}},[n("canvas",{ref:"canvas",attrs:{width:t.width,height:t.height}})])},R=[];function $(t){n("tygN")}var T=!1,C=$,E="data-v-4c5174fb",N=null,j=Object(g["a"])(x,P,R,T,C,E,N),D=j.exports;function k(t,e,n){var i=function(i){var r=function(n){i.addEventListener(n,function(r){r.relatedTarget||A(n,r,e,t,i)})},a=!0,s=!1,o=void 0;try{for(var h,u=n[Symbol.iterator]();!(a=(h=u.next()).done);a=!0){var c=h.value;r(c)}}catch(t){s=!0,o=t}finally{try{a||null==u.return||u.return()}finally{if(s)throw o}}},r=!0,a=!1,s=void 0;try{for(var o,h=t[Symbol.iterator]();!(r=(o=h.next()).done);r=!0){var u=o.value;i(u)}}catch(t){a=!0,s=t}finally{try{r||null==h.return||h.return()}finally{if(a)throw s}}}function A(t,e,n,i,r){var a=r.getBoundingClientRect(),s=a.left,o=a.top;i.forEach(function(i,a){if(i!=r){var h=i.getBoundingClientRect(),u=h.left,c=h.top,d=new MouseEvent(t,{bubbles:!0,cancelable:!0,relatedTarget:r,clientX:e.clientX-s+u,clientY:e.clientY-o+c});n[a].dispatchEvent(d)}})}var O={components:{Mandelbrot:_,MandelbrotWasm:D},mounted:function(){var t=this.$refs.jsM,e=this.$refs.wasmM;k([t.$vnode.elm,e.$vnode.elm],[t.getTarget(),e.getTarget()],["mousedown","mousemove","mouseup"])}},X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",[n("h1",[t._v("js")]),n("mandelbrot",{ref:"jsM",attrs:{width:640,height:500}})],1),n("div",[n("h1",[t._v("rust")]),n("mandelbrot-wasm",{ref:"wasmM",attrs:{width:640,height:500}})],1)])},W=[];function Y(t){n("+VGo")}var B=!1,K=Y,L=null,S=null,G=Object(g["a"])(O,X,W,B,K,L,S),H=G.exports;i["a"].config.productionTip=!1,new i["a"]({render:function(t){return t(H)}}).$mount("#app")},tygN:function(t,e){}},[0]);
//# sourceMappingURL=app.72f22be7.js.map